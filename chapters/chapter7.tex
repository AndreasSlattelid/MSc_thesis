\chapter{Numerical Simulation}

\section{Introduction}

Assume that we can model the \textbf{ESG-index} as: 
\[
X(t) = 100\exp(-Z(t))
\]

Where $Z(t)$ is an OU-process given by: 
\begin{align*}
dZ(t) &= -\beta Z(t)dt + dI(t)    
\end{align*} 
and: 
\begin{align*}
I(t) &= \sum_{k=1}^{N(t)}J_{k}, \;\; J_{k}\sim Exp(\mu),\;\; N(t) \sim Pois(\lambda t)    
\end{align*} 

For $J\sim Exp(\mu)$, we have:
\begin{align*}
f_{J}(x) &= \mu e^{-\mu x}\mathbbm{1}_{[0,\infty)}(x), \;\; 
\E[J] = \frac{1}{\mu}, \;\text{and}\; Var[J] = \frac{1}{\mu^{2}}
\end{align*}

An explicit solution is given by: 
\begin{align}
\label{eq: characteristic_function_Z(t)}
d[e^{\beta t}Z(t)] &= d[e^{\beta t}]Z(t) + e^{\beta t}dZ(t) \nonumber \\ 
&= \beta e^{\beta t}Z(t)dt + e^{\beta t}[-\beta Z(t)dt + dI(t)]
\nonumber \\ 
&= e^{\beta t}dI(t) \nonumber \\ 
&\Downarrow \nonumber\\ 
Z(t) &= Z(0)e^{-\beta t} + \int_{0}^{t}e^{-\beta (t-s)}dI(s)
\end{align} 


We can also control the limiting distribution of $Z$, by Theorem (\textbf{SATO 1999, thm 17, find this reference later}) 

\newpage 

\begin{proposition}
\begin{align*}
\E\left[
\exp(iu Z(t))
\right] 
&= 
\exp\left(
iuZ(0)e^{-\beta t}\right)
\left(
\frac{
1-iue^{-\beta t}1/\mu}
{
1-iu1/\mu
}
\right)^{\frac{\lambda}{\beta}}
\end{align*}
\end{proposition}

\begin{proof}
Now the characteristic function of Equation \ref{eq: characteristic_function_Z(t)}, is given by: 
\begin{align*}
\E\left[
\exp(iu Z(t))
\right] 
&= 
\exp\left(
iuZ(0)e^{-\beta t}\right) 
\E\left[
\exp\left(iu\int_{0}^{t}e^{-\beta(t-s)}dI(s)\right)
\right]
\end{align*}

Furthermore from Proposition \ref{prop: Integral_g(s)dI(s)}, we have: 
\begin{align*}
\E\left[
\exp\left(iu\int_{0}^{t}e^{-\beta(t-s)}dI(s)\right)
\right] 
&= 
\exp\left(
\int_{0}^{t}\Psi(ue^{-\beta s})ds
\right)
\end{align*}

To ease some notation, we write:
\begin{align*}
\Psi(x) &= \lambda(\varphi_{F}(x) - 1), \;\text{where:}\; 
\varphi_{F}(x) = \int_{\R}e^{iyx}F_{J}(dy) 
\end{align*}

We start with calculating $\varphi_{F}(x)$ with $F_{J}(dy) = 
\mu e^{-\mu y}\mathbbm{1}_{[0,\infty)}(y)dy:$ 
\begin{align*}
\varphi_{F}(x) &= 
\int_{0}^{\infty}e^{ixy}\mu e^{-\mu y}dy   
= \frac{1}{1-ix\frac{1}{\mu}}
\end{align*}

Giving us:
\begin{align*}
\varphi_{F}(x) - 1
= 
\frac{1}{1-ix\frac{1}{\mu}} - \frac{1-ix\frac{1}{\mu}}{1-ix\frac{1}{\mu}} 
= 
\frac{ix\frac{1}{\mu}}{1-ix\frac{1}{\mu}}
\end{align*}

Now: 
\begin{align*}
\Psi(ue^{-\beta s}) &= \lambda(\varphi_{F}(ue^{-\beta s})) -1) \\ 
&= \lambda\left(
\frac{iue^{-\beta s}1/\mu}{1-iue^{\beta s}1/\mu}
\right)\cdot \frac{\beta}{\beta} \\ 
&= 
\frac{\lambda}{\beta}\left(
\frac{\beta iue^{-\beta s}1/\mu}{1-iue^{\beta s}1/\mu}
\right)
\end{align*}

We observe: 
\begin{align*}
h(s) :&= \ln[1-iue^{-\beta s}1/\mu] \\ 
&\Downarrow \\ 
h'(s) &= \frac{\beta iue^{-\beta s}1/\mu}{1-iue^{\beta s}1/\mu} 
\end{align*}

Leaving us with: 
\begin{align*}
\int_{0}^{t}\Psi(ue^{-\beta s})ds
&= 
\frac{\lambda}{\beta}\int_{0}^{t}h'(s)ds
= 
\frac{\lambda}{\beta}[h(t)-h(0)] 
= 
\frac{\lambda}{\beta}
\ln\left[
\frac{1-iue^{-\beta t}1/\mu}{1-iu1/\mu}
\right]
\end{align*}

Thus:
\begin{align*}
\E\left[
\exp(iu Z(t))
\right] 
&= 
\exp\left(
iuZ(0)e^{-\beta t}\right)
\left(
\frac{
1-iue^{-\beta t}1/\mu}
{
1-iu1/\mu
}
\right)^{\frac{\lambda}{\beta}}
\end{align*}
\end{proof}

We can only control the asymptotic distribution of $X$, now if $\beta > 0$, then:  
\begin{align*}
\varphi_{Z_{\infty}}(u) &= 
\frac{\lambda}{\beta}
\int_{0}^{\infty} 
\frac{
\beta iu\eta e^{\beta s}\frac{1}{\mu}
}{
1-iu\eta e^{-\beta s} \frac{1}{\mu}
}ds \\ 
&= 
\exp\left(
\frac{\lambda}{\beta}\ln\left[
1- i\frac{1}{\mu}u\eta e^{-\beta s}
\right]\bigg{|}_{0}^{\infty}
\right) \\ 
&= 
\exp\left(
-\frac{\lambda}{\beta}\ln(1-i\frac{1}{\mu}u\eta)
\right) \\ 
&= 
\frac{1}{
(1-i\frac{1}{\mu}u\eta)^{\frac{\lambda}{\beta}}
}
\end{align*}

Here we use that if $M \sim \Gamma(a,b)$, then: 
\begin{align*}
f_{M}(x;a,b) &= \frac{1}{b^{a}\Gamma(a)}x^{a-1}e^{-\frac{x}{b}}\mathbbm{1}(x>0)\;\text{and}\; 
\varphi_{M}(u) = (1-biu)^{-a}
\end{align*}

We have that: 
\begin{align*}
\varphi_{Z_{\infty}}(u) &= 
\frac{1}{
(1-i\frac{1}{\mu}u\eta)^{\frac{\lambda}{\beta}}
}
= 
\left(
1 - \frac{\eta}{\mu}iu
\right)^{-\frac{\lambda}{\beta}}
\end{align*}

Meaning that
\[
Z_{\infty} \sim \Gamma\left(
\frac{\lambda}{\beta}, \frac{\eta}{\mu}
\right)
\]

Thus if one for instance have $\lambda = 10, \beta = 1, \eta = 1$ and $\mu = \frac{1}{2}$, giving us $a = 10$ and $b= 2$, then the density of $Z_{\infty}\sim \Gamma(10,2)$ would look like:

\begin{figure}[htp]
    \centering
    \includegraphics[width=10cm]{figures/ESG/gamma_limiting_dist.png}
    \caption{Distribution of $\Gamma(10, 2)$}
    \label{fig: gamma_limiting_dist}
\end{figure}

\newpage 

\section{Simulation of Zero Coupon Bond ESG-swap}

\textbf{Agreement}: 
\begin{itemize}[leftmargin =*]
    \item We agree upon $C^{ESG} = (C_{T_{i}}^{ESG})_{i\in \{1,2,3,4\}} = (17.6, 16.6, 15.6, 14.55)$ 
    \item One evaluates the ESG-risk score at $(T_{1}, T_{2}, T_{3}, T_{4}) = (1.25, 2.25, 3.25, 4.25)$
\end{itemize}

\textbf{Parameters}:
\begin{itemize}
    \item $d = 0.005$
    \item $\delta = 1$
    \begin{align*}
    \left(
    Z(0) = -\ln(\frac{20}{100}), \beta = -0.05, \lambda = 20, \mu = 150, \Delta t = \frac{1}{360}
    \right)   
\end{align*} 
    \item \begin{align*}
        \left(
        P(t,T_{0}) = 0.995, P(t,T_{1}) = 0.985, P(t,T_{3}) = 0.975, P(t,T_{4}) = 0.965
        \right)
    \end{align*}
    \item Number of simulations: $10^{6}$
\end{itemize}

We assume that the dynamics under $Q$ look the following: 
\begin{figure}[htp]
    \centering
    \includegraphics[width=10cm]{figures/ESG/ESG_OU_path.png}
    \caption{trajectory of $X(t)$}
    \label{fig: ESG-risk score}
\end{figure}

This graph indicates that the ESG-risk score is downward trending, this could be that the company are/will implement measures to reduce $CO_{2}$-emissions.
The blue dots represent the ESG-risk score at times $T_{i}$. 


\newpage 

In this simulation we got: 
\begin{align*}
\kappa_{t}^{ZCB} &= \frac{P(t,T_{0})-P(t,T_{4})}{\delta \sum_{i=1}^{4}P(t,T_{i})} = 0.01030   
\end{align*}

\begin{figure}[htp]
    \centering
    \includegraphics[width= 9cm]{figures/ESG/ESG_plt_criteria.png}
    \caption{ESG-risk score where ESG-criteria is reasonable}
    \label{fig: ESG-risk_criteria1}
\end{figure}

In this figure, we see the underlying ESG risk score process. Here the dark-solid lines represent the criteria $C_{T_{i}}^{ESG}$. We see that the ESG criteria were bearly met at time $T_{1}$, it was not met at $T_{2}$, met at $T_{3}$ and then met again at time $T_{4}$. 
\\~\\ 
We summarize the findings in the following table:
\begin{center}
    \begin{tabular}{ | l | l | l | p{5cm} |}
    \hline
    Time    &   Criteria  & $\kappa_{t}^{ESG}(i)$ \\ \hline
    $T_{1}$ &      17.6   & $0.01224$  \\ \hline
    $T_{2}$ &      16.6   & $0.01119$  \\ \hline
    $T_{3}$ &      15.6   & $0.01023$  \\ \hline
    $T_{4}$ &      14.55  & $0.00780$   \\ \hline
    \end{tabular}
\end{center} 

\begin{figure}[htp]
    \centering
    \includegraphics[width= 10cm]{figures/ESG/kappa_t_ESG_1.png}
    \caption{ESG-risk score where ESG-criteria is reasonable}
    \label{fig: ESG_swap_1}
\end{figure}

\newpage 

\textbf{Meeting criteria often}
\\~\\ 
In this simulation we took: $C^{ESG} = (18,17,16,15)$, and we got the following: 

\begin{figure}[htp]
    \centering
    \includegraphics[width= 9cm]{figures/ESG/ESG_plt_criteria2.png}
    \caption{ESG-risk score where ESG-criteria is met often}
    \label{fig: ESG-risk_score_criteri2}
\end{figure}

In this particular we met the criteria at all time points $T_{i}$ for $i=1,2,3$. 


\begin{center}
    \begin{tabular}{ | l | l | l | p{5cm} |}
    \hline
    Time    & Criteria   & $\kappa_{t}^{ESG}(i)$ \\ \hline
    $T_{1}$ &   18       & $0.01046$  \\ \hline
    $T_{2}$ &   17       & $0.00876$  \\ \hline
    $T_{3}$ &   16       & $0.00605$\\ \hline
    $T_{4}$ &   15       & $0.00273$ \\ \hline
    \end{tabular}
\end{center} 

\begin{figure}[htp]
    \centering
    \includegraphics[width= 10cm]{figures/ESG/kappa_t_ESG_2.png}
    \caption{Meeting criteria often}
    \label{fig: ESG_swap_2}
\end{figure}

In this simulation, we got almost the swap rate at time $T_{1}$, and then the company met the criteria for $i=2,3,4$, giving a lower fixed rate. 


\newpage
\textbf{Never meeting criteria}
\\~\\ 
In this simulation we took: $C^{ESG} = 2.5$, for all timepoints and got: 

\begin{figure}[htp]
    \centering
    \includegraphics[width=9cm]{figures/ESG/ESG_plt_criteria3.png}
    \caption{ESG-risk score where ESG-criteria is never met}
    \label{fig: ESG-risk_score_criteria3}
\end{figure}




\begin{center}
    \begin{tabular}{ | l | l | l | p{5cm} |}
    \hline
    Time    & Criteria  & $\kappa_{t}^{ESG}(i)$ \\ \hline
    $T_{1}$ &    2.5    & $0.0153$  \\ \hline
    $T_{2}$ &    2.5    & $0.0203$  \\ \hline
    $T_{3}$ &    2.5    & $0.0253$\\ \hline
    $T_{4}$ &    2.5    & $0.0303$ \\ \hline
    \end{tabular}
\end{center} 


\begin{figure}[htp]
    \centering
    \includegraphics[width=10cm]{figures/ESG/kappa_t_ESG_3.png}
    \caption{ESG swap rate when ESG-criteria is never met}
    \label{fig: ESG_swap_3}
\end{figure} 

We see the effect of the penalty $d = 0.005$, leading to an upward-trending ESG swap rate. 









